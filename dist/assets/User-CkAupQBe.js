import{c as w,$ as H,a0 as L,a1 as W,a2 as P,a3 as q,a4 as Y,a5 as Z,i as g,u as U,j as e,M as o,B as j,a as S,b as $,r as u,g as J}from"./index-Cy1U88sa.js";import{F,E as K,e as Q,U as X,u as k}from"./Modal-BGjb3hrj.js";import{F as b,a,C as l,E as ee}from"./formik.esm-Ck2ofJqQ.js";import{R as d}from"./Row--G6XAMP6.js";import{c as se,a as te}from"./index.esm-DSeJ6hL8.js";import{l as A}from"./lodash-7L2L8PGe.js";import"./moment-Cl4UOzQZ.js";const B=s=>s.user,ne=w([B],s=>s.user),ie=w([B],s=>s.employee),le=s=>({type:H,payload:s}),ce=s=>({type:Z,payload:s}),ae=s=>({type:W,payload:s}),re=s=>({type:P,payload:s}),oe=s=>({type:q,payload:s}),de=s=>({type:Y,payload:s}),z=s=>({type:L,payload:s}),me=()=>g.get("/api/user/"),he=s=>g.post("/api/user/create/",s),ue=s=>g.get("/api/user/employee?query="+s.search),xe=s=>g.put("/api/user/update/",s),je=s=>g.put("/api/user/freeze/"+s.login_id+"/",s),T=s=>n=>{me().then(c=>{n(le(c.data)),s&&s(null,"Success")}).catch(c=>{var t;n(z()),s&&s(((t=c==null?void 0:c.response)==null?void 0:t.data)||c,null)})},Se=(s,n)=>async c=>{try{const t=await he(s);c(ce()),t.status===200?n&&n(200,"Success"):n&&n(t.data.message)}catch(t){console.log(t),n&&n(t.response.data.message||t,null)}},ve=(s,n)=>c=>{ue(s).then(t=>{c(ae(t.data)),n&&n(null,"Success")}).catch(t=>{var x;c(z()),n&&n(((x=t==null?void 0:t.response)==null?void 0:x.data)||t,null)})},ye=()=>s=>{s(re())},fe=(s,n)=>async c=>{try{const t=await xe(s);c(oe()),t.status===200?n&&n(200,"Success"):n&&n(t.status||t.statusText,"Error occurred")}catch(t){console.log(t),n&&n(t.status||t,null)}},ge=(s,n)=>async c=>{try{const t=await je(s);c(de()),t.status===200?n&&n(200,"Success"):n&&n(t.status||t.statusText,"Error occurred")}catch(t){console.log(t),n&&n(t.status||t,null)}},_e=s=>{const n=U(),{refetchUserData:c}=s,t=(r,h)=>{r===200?S.success("Success Edit Changes",{position:"bottom-right"}):S.error(h||"An error occurred",{position:"bottom-right"})},x=r=>{const h={login_id:s.userState[0].login_id,user_role:r.user_role};n(fe(h,t)),c(),s.close(!0)},m=()=>{const r={login_id:s.userState[0].login_id,status:s.userState[0].status};n(ge(r,t)),c(),s.close(!0)};return e.jsx("div",{children:e.jsx(o,{show:s.show,onHide:s.close,size:"xm",children:e.jsx(b,{initialValues:{user_role:s.userState&&s.userState.length>0?s.userState[0].user_role:""},onSubmit:x,children:({handleSubmit:r,handleChange:h,values:v})=>e.jsxs(a,{onSubmit:r,children:[e.jsx(o.Header,{closeButton:!0,children:e.jsxs(o.Title,{children:["Edit Account #",s.idState[0].id]})}),e.jsxs(o.Body,{children:[e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"NT Login:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.userState[0].login_id})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"CCMS ID:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.userState[0].ccms_id})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Full Name:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.userState[0].employee_full_name})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Email:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.userState[0].email})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Role:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsxs("select",{className:"form-select",name:"user_role",value:v.user_role,onChange:h,children:[e.jsx("option",{value:"ADMIN",children:"ADMIN"}),e.jsx("option",{value:"OWNER",children:"OWNER"})]})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Status:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.userState[0].status==="active"?"ACTIVE":"INACTIVE"})})})})]})]}),e.jsxs(o.Footer,{children:[e.jsx(j,{variant:"secondary",onClick:s.close,children:"Cancel"}),e.jsx(j,{variant:s.userState[0].status==="active"?"danger":"success",onClick:()=>m(),children:s.userState[0].status==="active"?"Inactive":"Active"}),e.jsx(j,{type:"submit",className:"btn-color",variant:"primary",children:"Save"})]})]})})})})},Ee=s=>{const n=U(),{refetchUserData:c}=s,t=m=>{m===200?S.success("Success Add Employee",{position:"bottom-right"}):S.error(m,{position:"bottom-right"})},x=m=>{const r={login_id:s.employeeState[0].login_id,username:s.employeeState[0].login_id,ccms_id:s.idState[0].employee_ident,email:s.employeeState[0].email1,employee_full_name:s.employeeState[0].employee_common_name,user_role:m.user_role,status:m.status};n(Se(r,t)),c(),s.close(!0),s.onClose()};return e.jsx("div",{children:e.jsx(o,{show:s.show,onHide:s.close,size:"xm",children:e.jsx(b,{initialValues:{user_role:"OWNER",status:"active"},onSubmit:x,children:({handleSubmit:m,handleChange:r,values:h})=>e.jsxs(a,{onSubmit:m,children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Confirm Add this Employee"})}),e.jsxs(o.Body,{children:[e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"CCMS ID:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.idState[0].employee_ident})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"NT Login:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.employeeState[0].login_id})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Full Name:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.employeeState[0].employee_common_name})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Email:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsx("div",{children:s.employeeState[0].email1})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Role:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsxs("select",{className:"form-select",value:h.user_role,name:"user_role",onChange:r,children:[e.jsx("option",{value:"OWNER",children:"OWNER"}),e.jsx("option",{value:"ADMIN",children:"ADMIN"})]})})})})]}),e.jsxs(d,{className:"mb-3",children:[e.jsx(l,{md:"3",children:e.jsx("div",{className:"strong",children:"Status:"})}),e.jsx(l,{md:"8",children:e.jsx("div",{children:e.jsx(a.Group,{children:e.jsxs("select",{className:"form-select",value:h.status,name:"status",onChange:r,children:[e.jsx("option",{value:"active",children:"ACTIVE"}),e.jsx("option",{value:"inactive",children:"INACTIVE"})]})})})})]})]}),e.jsxs(o.Footer,{children:[e.jsx(j,{variant:"secondary",onClick:s.close,children:"Cancel"}),e.jsx(j,{type:"submit",className:"btn-color",variant:"primary",children:"Save"})]})]})})})})},Ne=s=>{const n=U(),c=$(ie),{refetchUserData:t}=s,[x,m]=u.useState([]),[r,h]=u.useState([]),[v,_]=u.useState(!1),[G,C]=u.useState(""),y=()=>_(!1),p={search:""},E=i=>{if(i){const D=(i==null?void 0:i.error)||i;S.error(D,{position:"bottom-right"})}},R=A.debounce(i=>{n(ve(i,E))},300),I=i=>{R(i)},M=se().shape({search:te().required("Empty Value is Invalid")}),f=()=>{n(ye()),s.close()},N=i=>{C(i),_(!0),m([{employee_ident:i.employee_ident}]),h([{employee_common_name:i.employee_common_name,login_id:i.login_id,email1:i.email1}])};return e.jsxs("div",{className:"modal",children:[e.jsxs(o,{show:s.show,onHide:f,size:"xl",children:[e.jsx(o.Header,{closeButton:!0,children:e.jsx(o.Title,{children:"Please Select User to Add"})}),e.jsxs(o.Body,{children:[e.jsx(b,{onSubmit:I,initialValues:p,validationSchema:M,children:({handleSubmit:i,handleChange:D,values:O,errors:V})=>e.jsx(a,{onSubmit:i,children:e.jsxs(d,{children:[e.jsxs(a.Group,{as:l,md:4,children:[e.jsx(a.Control,{type:"text",name:"search",placeholder:"Search Employee to Add",value:O.search,onChange:D,isInvalid:!!V.search}),e.jsx(ee,{name:"search",component:"div",className:"text-danger"})]}),e.jsx(a.Group,{as:l,md:1,children:e.jsx(j,{type:"submit",children:"Search"})})]})})}),e.jsx("br",{}),e.jsx(F,{columns:K,data:c,filterItems:Q,handleRowClick:N})]}),e.jsx(o.Footer,{children:e.jsx(j,{variant:"secondary",onClick:f,children:"Close"})})]}),e.jsx(Ee,{show:v,close:y,idState:x,onClose:f,employeeState:r,refetchUserData:t})]})},Ae=()=>{const[s,n]=u.useState(!1),[c,t]=u.useState(!1),[x,m]=u.useState(""),r=()=>n(!1),h=()=>t(!1),[v,_]=u.useState([]),[G,C]=u.useState([]),y=U(),p=$(ne),E=A.debounce(()=>{y(J())},300),R=A.debounce(()=>{y(T())},300);u.useEffect(()=>(y(T(I)),E(),()=>{E.cancel()}),[]);const I=i=>{i&&S.error(i==null?void 0:i.error,{position:"bottom-right"})},M="User",f=i=>{m(i),n(!0),C([{id:i.id}]),_([{login_id:i.login_id,ccms_id:i.ccms_id,employee_full_name:i.employee_full_name,email:i.email,user_role:i.user_role,status:i.status}])},N=()=>{R()};return e.jsxs("div",{className:"user",children:[e.jsx(j,{className:"btn-color",onClick:()=>t(!0),children:"Add User"}),e.jsx(d,{className:"mb-4"}),e.jsx(F,{columns:X,data:p,filterItems:k,handleRowClick:f}),e.jsx(Ne,{show:c,close:h,refetchUserData:N}),e.jsx(_e,{show:s,close:r,modalName:M,userState:v,idState:G,refetchUserData:N})]})};export{Ae as default};
